name: Generate changelog
on:
  release:
    types: [created, edited]

jobs:
  generate-changelog:
    runs-on: ubuntu-latest
    outputs:
      changelog: ${{ steps.changelog.outputs.changelog }}
    steps:
    - uses: actions/checkout@v3
    - name: "âœï¸ Generate release changelog"
      id: changelog
      uses: liya2017/auto-generator-changelog@main
      with:
          token: ${{ secrets.GITHUB_TOKEN }}
          headerLabel: "# ğŸ“‘ Changelog"
<<<<<<< HEAD
          addSections: '{"documentation":{"prefix":"### ğŸ“– Documentation","labels":["document"]},"Features":{"prefix":"### ğŸš€ Features","labels":["feature"]},"Enhancement":{"prefix":"### ğŸ”¥ Enhancement","labels":["enhancement"]},"bugfix":{"prefix":"ğŸ› Bug Fixes","labels":["bugfix"]},"refactor":{"prefix":"### ğŸ  refactor","labels":["refactor"]},"chore":{"prefix":"### ğŸ§° Chore","labels":["chore"]},"Otherchanges":{"prefix":"âœ¨ Other changes","labels":[""]},"dependencies":{"prefix":"â¬†ï¸ Dependency Updates","labels":["dependencies"]},"style":{"prefix":"ğŸŒˆ Style","labels":["style"]}}'
=======
          addSections: '{"documentation":{"prefix":"### ğŸ“– Documentation","labels":["document"]},"Features":{"prefix":"### ğŸš€ Features","labels":["feature"]},"Enhancement":{"prefix":"### ğŸš€ Enhancement","labels":["enhancement"]},"bugfix":{"prefix":"ğŸ› Bug Fixes","labels":["bugfix"]},"refactor":{"prefix":"### ğŸ  refactor","labels":["refactor"]},"chore":{"prefix":"### ğŸ§° Chore","labels":["chore"]},"Otherchanges":{"prefix":"âœ¨ Other changes","labels":[""]},"dependencies":{"prefix":"â¬†ï¸ Dependency Updates","labels":["dependencies"]},"style":{"prefix":"ğŸŒˆ Style","labels":["style"]}}'
>>>>>>> c3ddb29 (ci: workflow to generate changlog)
          author: true
          compareLink: true
          stripGeneratorNotice: true
  create-changelog-pr:
    runs-on: ubuntu-latest
    needs: generate-changelog
    steps:
    - uses: actions/checkout@v3
      with: 
        ref: main
    - run: |
       echo "${{ needs.generate-changelog.outputs.changelog }}" >${{ github.workspace }}/CHANGELOG.md
    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v4
      with:
        token: ${{ secrets.TOKEN }}
        signoff: false
<<<<<<< HEAD
        commit-message: "docs: automated update CHANGELOG.md"
        branch: bot-${{ github.repository }}
        title: "docs: automated update CHANGELOG.md"
        commit-message: "feat: automated pr to change config files"
=======
        commit-message: "docs: automated update CHANGELOG.mds"
>>>>>>> 94bbc12 (ci: update commit message)
        branch: bot-${{ github.repository }}
        title: "feat: automated pr to change log"
        body: "automated pr to change log"
