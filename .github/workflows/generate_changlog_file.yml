name: Generate changelog
on:
  release:
    types: [created, edited]

jobs:
  generate-changelog:
    runs-on: ubuntu-latest
    outputs:
      changelog: ${{ steps.changelog.outputs.changelog }}
    steps:
    - uses: actions/checkout@v3
    - name: "‚úèÔ∏è Generate release changelog"
      id: changelog
      uses: liya2017/auto-generator-changelog@main
      with:
          token: ${{ secrets.GITHUB_TOKEN }}
          headerLabel: "# üìë Changelog"
<<<<<<< HEAD
<<<<<<< HEAD
          addSections: '{"documentation":{"prefix":"### üìñ Documentation","labels":["document"]},"Features":{"prefix":"### üöÄ Features","labels":["feature"]},"Enhancement":{"prefix":"### üî• Enhancement","labels":["enhancement"]},"bugfix":{"prefix":"üêõ Bug Fixes","labels":["bugfix"]},"refactor":{"prefix":"### üêù  refactor","labels":["refactor"]},"chore":{"prefix":"### üß∞ Chore","labels":["chore"]},"Otherchanges":{"prefix":"‚ú® Other changes","labels":[""]},"dependencies":{"prefix":"‚¨ÜÔ∏è Dependency Updates","labels":["dependencies"]},"style":{"prefix":"üåà Style","labels":["style"]}}'
=======
          addSections: '{"documentation":{"prefix":"### üìñ Documentation","labels":["document"]},"Features":{"prefix":"### üöÄ Features","labels":["feature"]},"Enhancement":{"prefix":"### üöÄ Enhancement","labels":["enhancement"]},"bugfix":{"prefix":"üêõ Bug Fixes","labels":["bugfix"]},"refactor":{"prefix":"### üêù  refactor","labels":["refactor"]},"chore":{"prefix":"### üß∞ Chore","labels":["chore"]},"Otherchanges":{"prefix":"‚ú® Other changes","labels":[""]},"dependencies":{"prefix":"‚¨ÜÔ∏è Dependency Updates","labels":["dependencies"]},"style":{"prefix":"üåà Style","labels":["style"]}}'
>>>>>>> c3ddb29 (ci: workflow to generate changlog)
=======
          addSections: '{"documentation":{"prefix":"### üìñ Documentation","labels":["document"]},"Features":{"prefix":"### üöÄ Features","labels":["feature"]},"Enhancement":{"prefix":"### üî• Enhancement","labels":["enhancement"]},"bugfix":{"prefix":"üêõ Bug Fixes","labels":["bugfix"]},"refactor":{"prefix":"### üêù  refactor","labels":["refactor"]},"chore":{"prefix":"### üß∞ Chore","labels":["chore"]},"Otherchanges":{"prefix":"‚ú® Other changes","labels":[""]},"dependencies":{"prefix":"‚¨ÜÔ∏è Dependency Updates","labels":["dependencies"]},"style":{"prefix":"üåà Style","labels":["style"]}}'
>>>>>>> 0308bf9 (ci: update prefix image)
          author: true
          compareLink: true
          stripGeneratorNotice: true
  create-changelog-pr:
    runs-on: ubuntu-latest
    needs: generate-changelog
    steps:
    - uses: actions/checkout@v3
      with: 
        ref: main
    - run: |
       echo "${{ needs.generate-changelog.outputs.changelog }}" >${{ github.workspace }}/CHANGELOG.md
    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v4
      with:
        token: ${{ secrets.TOKEN }}
        signoff: false
<<<<<<< HEAD
<<<<<<< HEAD
        commit-message: "docs: automated update CHANGELOG.md"
        branch: bot-${{ github.repository }}
        title: "docs: automated update CHANGELOG.md"
        commit-message: "feat: automated pr to change config files"
=======
        commit-message: "docs: automated update CHANGELOG.mds"
>>>>>>> 94bbc12 (ci: update commit message)
=======
        commit-message: "docs: automated update CHANGELOG.md"
>>>>>>> 0308bf9 (ci: update prefix image)
        branch: bot-${{ github.repository }}
        title: "docs: automated update CHANGELOG.md"
        body: "automated pr to change log"
